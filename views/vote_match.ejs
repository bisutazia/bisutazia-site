<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title><%= match.home %> vs <%= match.away %> - ピカイチ投票 | ビスタジア</title>
  <meta name="description" content="Jリーグ・WEリーグ全試合対応！あなたが「一番輝いた」と思う選手をピカイチ投票しよう。今すぐ熱い一票を！">
  <meta property="og:title" content="ピカイチ投票 | <%= match.home %> vs <%= match.away %> | ビスタジア" />
  <meta property="og:description" content="一番輝いた選手に投票しよう！あなたの一票が選手の誇りに。今すぐ投票！" />
  <meta property="og:image" content="https://bisutazia.com/ogp.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="ピカイチ投票 | <%= match.home %> vs <%= match.away %> | ビスタジア" />
  <meta name="twitter:description" content="あなたが選ぶ一番輝いた選手にピカイチ投票しよう！" />
  <meta name="twitter:image" content="https://bisutazia.com/ogp.png" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+JP:400,700">
  <style>
    :root {
      --primary: #004c99;
      --accent: #ff5722;
      --highlight: #ffe066;
      --bg: #f8fafd;
      --card-bg: #fff;
      --danger: #d32f2f;
      --text: #232b34;
      --shadow: 0 2px 12px rgba(0,0,0,0.08);
    }
    html, body { height:100%; }
    body {
      font-family: 'Noto Sans JP',sans-serif;
      background: var(--bg);
      margin: 0; padding: 0; color: var(--text);
      min-height: 100vh;
      -webkit-tap-highlight-color:transparent;
    }
    .container {
      max-width: 430px;
      margin: 0 auto;
      padding: 0 0.6em 1.5em;
    }
    .hero {
      background: linear-gradient(120deg, #004c99 92%, #4ea7ff 100%);
      color: #fff;
      border-radius: 16px;
      padding: 1.7em 1em 1.1em 1em;
      margin-top: 1.3em;
      margin-bottom: 0.9em;
      text-align: center;
      box-shadow: var(--shadow);
    }
    .hero h1 {
      font-size: 1.27em;
      margin: 0 0 0.36em 0;
      font-weight: bold;
      line-height: 1.35;
      text-shadow: 0 2px 7px rgba(0,0,0,0.12);
    }
    .hero .match-names {
      font-size: 1.12em;
      font-weight: bold;
      margin-top: 0.9em;
      color: #ffe066;
      letter-spacing: 0.01em;
    }
    .hero .sub-msg {
      font-size: 1.03em;
      color: #fffbe7;
      margin-top: 0.85em;
      line-height: 1.5;
    }
    .vote-box {
      background: var(--card-bg);
      border-radius: 14px;
      box-shadow: var(--shadow);
      padding: 1.1em 0.7em 1.0em 0.7em;
      margin-bottom: 1.0em;
      margin-top: 1.0em;
      display: flex;
      flex-direction: column;
      gap: 0.4em;
    }
    .vote-label {
      font-weight: 700;
      font-size: 1.07em;
      color: var(--primary);
      margin-bottom: 0.4em;
      text-align: left;
    }
    .vote-select-row {
      display: flex;
      gap: 0.4em;
      align-items: center;
      margin-bottom: 0.9em;
    }
    select {
      flex: 1 1 60%;
      padding: 0.72em;
      font-size: 1.04em;
      border-radius: 7px;
      border: 1px solid #b9d1e8;
      margin-right: 0.1em;
      background: #fafdff url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' fill='%23888'><polygon points='0,0 18,0 9,10'/></svg>") no-repeat right 12px center;
      background-size: 14px 14px;
      font-weight: 500;
      outline:none;
      transition:border 0.18s;
    }
    select:focus { border-color: var(--primary);}
    .vote-btn {
      display: block;
      width: 100%;
      background: linear-gradient(90deg, var(--accent), #ffca28 96%);
      color: #fff;
      font-size: 1.15em;
      font-weight: bold;
      padding: 0.98em 0;
      border: none;
      border-radius: 9px;
      margin-top: 0.1em;
      margin-bottom: 0.15em;
      box-shadow: 0 4px 16px rgba(255,87,34,0.10);
      letter-spacing: 0.03em;
      cursor: pointer;
      transition: background 0.16s;
    }
    .vote-btn:active, .vote-btn:hover { background: #ff8352; color: #fff; }
    .vote-btn:disabled {
      background-color: #bbb;
      cursor: not-allowed;
      color: #fff;
      box-shadow: none;
    }
    .already-voted-msg {
      background: #ecf2fb;
      color: var(--primary);
      font-size: 1.03em;
      padding: 0.9em 1em;
      border-radius: 8px;
      margin-bottom: 0.7em;
      text-align:center;
      font-weight:bold;
      letter-spacing:0.01em;
    }
    .footer {
      text-align: center;
      margin-top: 2.1em;
    }
    .footer a {
      color: var(--primary);
      text-decoration: none;
      font-weight: bold;
      font-size: 1em;
    }
    .footer a:hover { text-decoration: underline;}
    .vote-note {
      color: #888; font-size: 0.99em; text-align: center; margin: 1.1em 0 0.3em 0;
    }
    .expired-msg {
      color: var(--danger);
      font-weight: bold;
      margin: 2.2em 0 2em 0;
      text-align: center;
      font-size: 1.14em;
      background: #fff7f7;
      border-radius: 10px;
      padding: 1.2em 0.7em;
    }
    @media (max-width:480px){
      .container { padding:0 0.13em 1.3em;}
      .hero {padding:1.1em 0.6em 0.7em;}
      .vote-btn {font-size:1em;}
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="hero">
      <h1>ピカイチ投票</h1>
      <div class="match-names">
        <span><%= match.home %></span>
        <span style="margin:0 0.5em; font-size:0.98em; color:#fff;">VS</span>
        <span><%= match.away %></span>
      </div>
      <div class="sub-msg">
        「この試合で一番輝いた！」と思う選手に、<br>
        <b>あなたの“ピカイチ投票”をお願いします！</b>
      </div>
    </div>

    <% if (!expired) { %>
      <div class="vote-note">
        片方のチームだけの投票もOK！どちらか“心に残った選手”だけでも投票してみよう。
      </div>

      <!-- ホームチーム投票エリア -->
      <div class="vote-box">
        <form
          action="/vote/<%= match.id %>"
          method="post"
          onsubmit="return confirm('🔥本当に「<%= match.home %>」の『' + this.player.value + '』選手にピカイチ投票しますか？');"
        >
          <div class="vote-label">🏠 <strong><%= match.home %></strong> の中で一番輝いた選手</div>
          <div class="vote-select-row">
            <select name="player" required <%= voted.home ? "disabled" : "" %>>
              <option value="" disabled selected>選手を選んでください</option>
              <% (match.homePlayers || []).forEach(player => { %>
                <option value="<%= player %>"><%= player %></option>
              <% }) %>
            </select>
            <% if (!voted.home) { %>
              <button type="submit" class="vote-btn">この選手にピカイチ投票！</button>
            <% } else { %>
              <button type="button" class="vote-btn" disabled>✅ 投票済み</button>
            <% } %>
          </div>
        </form>
        <% if (voted.home) { %>
          <div class="already-voted-msg">
            ありがとうございます！あなたの投票は反映されています。
          </div>
        <% } %>
      </div>

      <!-- アウェイチーム投票エリア -->
      <div class="vote-box">
        <form
          action="/vote/<%= match.id %>"
          method="post"
          onsubmit="return confirm('🔥本当に「<%= match.away %>」の『' + this.player.value + '』選手にピカイチ投票しますか？');"
        >
          <div class="vote-label">🚩 <strong><%= match.away %></strong> の中で一番輝いた選手</div>
          <div class="vote-select-row">
            <select name="player" required <%= voted.away ? "disabled" : "" %>>
              <option value="" disabled selected>選手を選んでください</option>
              <% (match.awayPlayers || []).forEach(player => { %>
                <option value="<%= player %>"><%= player %></option>
              <% }) %>
            </select>
            <% if (!voted.away) { %>
              <button type="submit" class="vote-btn">この選手にピカイチ投票！</button>
            <% } else { %>
              <button type="button" class="vote-btn" disabled>✅ 投票済み</button>
            <% } %>
          </div>
        </form>
        <% if (voted.away) { %>
          <div class="already-voted-msg">
            ありがとうございます！あなたの投票は反映されています。
          </div>
        <% } %>
      </div>
    <% } else { %>
      <div class="expired-msg">
        ⏰ この試合のピカイチ投票受付は終了しました。
      </div>
    <% } %>

    <div class="footer">
      <a href="/">← ホームに戻って他の試合もピカイチ投票しよう！</a>
    </div>
  </div>
</body>
</html>
